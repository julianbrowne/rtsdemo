<html>
<head>
    <title>RTS Demo - Graphed Socket Receiver</title>
    <link rel="stylesheet" href="/stylesheets/style.css" />
    <link rel="stylesheet" href="/stylesheets/graph.css" />
    <script src='javascripts/d3.v2.min.js'></script>
    <script src='/socket.io/socket.io.js'></script>
    <script src='javascripts/graph.js'></script>
    <script>
/*
            var socket = io.connect('/');

            socket.on('stats-channel', function (data) {
                console.log('Received data');
                //$("#output").html(data._id);
            });
        });
*/
    </script>
</head>
<body>
    <h1>Graph Socket Receiver</h1>
    <div id="output" class="gallery">
        <button class="first last" onclick="transition()">Update</button>
    </div>
    <script>
            var n = 20, // number of layers
            m = 200, // number of samples per layer
            data0 = d3.layout.stack().offset("wiggle")(stream_layers(n, m)),
            data1 = d3.layout.stack().offset("wiggle")(stream_layers(n, m)),
            color = d3.interpolateRgb("#aad", "#556");

            var width = 960,
                height = 500,
                mx = m - 1,
                my = d3.max(data0.concat(data1), function(d) {
                  return d3.max(d, function(d) {
                    return d.y0 + d.y;
                  });
                });

            var area = d3.svg.area()
                .x(function(d) { return d.x * width / mx; })
                .y0(function(d) { return height - d.y0 * height / my; })
                .y1(function(d) { return height - (d.y + d.y0) * height / my; });

            var vis = d3.select("#output")
              .append("svg")
                .attr("width", width)
                .attr("height", height);

            console.log(vis.toString());

            vis.selectAll("path")
                .data(data0)
              .enter().append("path")
                .style("fill", function() { return color(Math.random()); })
                .attr("d", area);
    </script>
</body>
</html>